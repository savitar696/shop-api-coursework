# Shop API

–ë—ç–∫–µ–Ω–¥ –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –Ω–∞ NestJS —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º DDD –∏ CQRS.

## ‚ú® –°—Ç–µ–∫

*   NestJS
*   TypeScript
*   CQRS
*   Prisma
*   PostgreSQL
*   JWT
*   bcrypt
*   class-validator / class-transformer

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

*   Node.js (LTS)
*   npm / yarn / pnpm
*   PostgreSQL

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:**
    ```bash
    git clone https://github.com/savitar696/shop-api-coursework.git
    cd shop-api-coursework
    ```

2.  **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    npm install
    # –∏–ª–∏
    yarn install
    ```

3.  **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
    –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ (–º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å `.env.example`, –µ—Å–ª–∏ –µ—Å—Ç—å):
    ```dotenv
    DATABASE_URL="postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public"
    JWT_SECRET="your-strong-jwt-secret"
    PORT=3000
    ```
    –£–∫–∞–∂–∏—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è `DATABASE_URL` –∏ –ø—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π `JWT_SECRET`.

4.  **–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î:**
    –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ë–î –∑–∞–ø—É—â–µ–Ω–∞.
    ```bash
    npx prisma migrate dev --name init
    ```
    –ö–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ `prisma/schema.prisma`.

5.  **Prisma Client:**
    ```bash
    npx prisma generate
    ```
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç Prisma.

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

*   **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
    ```bash
    npm run start:dev
    # –∏–ª–∏
    yarn start:dev
    ```

*   **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
    ```bash
    # –°–Ω–∞—á–∞–ª–∞ —Å–±–æ—Ä–∫–∞
    npm run build
    # –∏–ª–∏
    yarn build

    # –ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫
    npm run start:prod
    # –∏–ª–∏
    yarn start:prod
    ```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:3000` (–∏–ª–∏ –Ω–∞ –ø–æ—Ä—Ç—É –∏–∑ `PORT`).

## üåê API –ú–∞—Ä—à—Ä—É—Ç—ã (Endpoints)

–ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ API.

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/auth`)

*   **`POST /auth/register`**
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Body):**
        ```json
        {
          "email": "user@example.com",
          "password": "yourpassword",
          "name": "Your Name"
        }
        ```
    *   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö):** `201 Created` - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –ø–∞—Ä–æ–ª—è).
    *   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `401 Unauthorized` (–µ—Å–ª–∏ email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç).

*   **`POST /auth/login`**
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Body):**
        ```json
        {
          "email": "user@example.com",
          "password": "yourpassword"
        }
        ```
    *   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö):** `200 OK` - `{ "access_token": "your_jwt_token" }`.
    *   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `401 Unauthorized` (–Ω–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ).

### –ü—Ä–æ–¥—É–∫—Ç—ã (`/products`)

*   **`GET /products`**
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤.
    *   **–û—Ç–≤–µ—Ç:** `200 OK` - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤.

*   **`GET /products/top-rated`**
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º (—Ç–æ–ø-10).
    *   **–û—Ç–≤–µ—Ç:** `200 OK` - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤.

*   **`GET /products/:id`**
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç –ø–æ ID.
    *   **–ü–∞—Ä–∞–º–µ—Ç—Ä URL:** `:id` (—á–∏—Å–ª–æ) - ID –ø—Ä–æ–¥—É–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/products/1`).
    *   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö):** `200 OK` - –û–±—ä–µ–∫—Ç –ø—Ä–æ–¥—É–∫—Ç–∞.
    *   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `404 Not Found` (–µ—Å–ª–∏ –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ ID –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω).

### –û—Ç–∑—ã–≤—ã (`/reviews`) - –¢—Ä–µ–±—É—é—Ç –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (JWT)

*   **`POST /reviews`**
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ—Ç–∑—ã–≤ –∫ –ø—Ä–æ–¥—É–∫—Ç—É.
    *   **–ó–∞–≥–æ–ª–æ–≤–∫–∏ (Headers):** `Authorization: Bearer <your_jwt_token>`
    *   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Body):**
        ```json
        {
          "productId": 1,          // ID –ø—Ä–æ–¥—É–∫—Ç–∞ (—á–∏—Å–ª–æ)
          "rating": 5,            // –†–µ–π—Ç–∏–Ω–≥ (—á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 5)
          "comment": "–Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å, —Å—Ç–∞–≤–ª—é –¥–∏–∑–ª–∞–π–∫, –ø—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ –≤–± —Ñ–∏–≥–Ω—è!"   // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (—Å—Ç—Ä–æ–∫–∞)
        }
        ```
    *   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö):** `201 Created` - –û–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –æ—Ç–∑—ã–≤–∞.
    *   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `401 Unauthorized` (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω/–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç), `404 Not Found` (–µ—Å–ª–∏ –ø—Ä–æ–¥—É–∫—Ç –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω—ã), `400 Bad Request` (–æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏).

*   **`GET /reviews/product/:productId`**
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Ç–∑—ã–≤—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.
    *   **–ó–∞–≥–æ–ª–æ–≤–∫–∏ (Headers):** `Authorization: Bearer <your_jwt_token>`
    *   **–ü–∞—Ä–∞–º–µ—Ç—Ä URL:** `:productId` (—á–∏—Å–ª–æ) - ID –ø—Ä–æ–¥—É–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/reviews/product/1`).
    *   **–û—Ç–≤–µ—Ç:** `200 OK` - –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –æ—Ç–∑—ã–≤–æ–≤ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º).
    *   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `401 Unauthorized` (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω/–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç).

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –ø–æ —Å–ª–æ—è–º (DDD-like):

*   `src/`
    *   `main.ts`: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞.
    *   `app.module.ts`: –ö–æ—Ä–Ω–µ–≤–æ–π –º–æ–¥—É–ª—å.
    *   `domain/`: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.
        *   `entities/`: –°—É—â–Ω–æ—Å—Ç–∏.
        *   `repositories/`: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã/—Ç–æ–∫–µ–Ω—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.
        *   `services/`: –î–æ–º–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã).
    *   `application/`: –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (Use Cases).
        *   `commands/`: –ö–æ–º–∞–Ω–¥—ã CQRS.
        *   `handlers/`: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ CQRS.
        *   `queries/`: –ó–∞–ø—Ä–æ—Å—ã CQRS (–µ—Å–ª–∏ –µ—Å—Ç—å).
        *   `dtos/`: DTO.
    *   `infrastructure/`: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ (–∞–¥–∞–ø—Ç–µ—Ä—ã).
        *   `prisma/`: Prisma.
        *   `repositories/`: –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.
        *   `auth/`: –õ–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏ —Ç.–¥.).
    *   `presentation/`: –°–ª–æ–π API (HTTP).
        *   `controllers/`: –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã.
        *   `modules/`: –ú–æ–¥—É–ª–∏ NestJS.
        *   `guards/`: Guards (Auth –∏ —Ç.–ø.).
        *   `decorators/`: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã.

## üë§ –ê–≤—Ç–æ—Ä

*   **GitHub:** [savitar696](https://github.com/savitar696)
*   **Telegram:** [@slowryz](https://t.me/slowryz)
